# Copilot Instructions for v-chatgpt-social-status-feeds

## Overview
This project is a modular PHP application for managing, scheduling, and distributing social media status updates. It uses a lightweight MVC architecture with controllers, models, and views organized under `root/app`. The application includes features like user authentication, account management, status scheduling, and real-time RSS feeds.

## Architecture
- **Core Components**:
  - `Controllers`: Handle HTTP requests and responses (e.g., `AuthController`, `UsersController`).
  - `Models`: Interact with the database (e.g., `User`, `Account`).
  - `Views`: Render HTML templates (e.g., `login.php`, `users.php`).
  - `Core`: Contains shared utilities like `Router`, `ErrorMiddleware`, and `Utility`.
- **Configuration**:
  - Centralized in `root/config.php`.
  - Includes database credentials, API keys, and security settings.
- **Routing**:
  - Managed by `Router.php`.
  - Routes are defined in controllers and mapped to views.
- **Database**:
  - Uses a MariaDB backend.
  - Schema is defined in `install.sql`.

## Developer Workflows
### Local Setup
1. Use Docker for local development:
   ```sh
   docker compose up
   ```
2. Access the application at `http://localhost`.
3. Install the database by visiting `/install.php`.

### Debugging
- Use `ErrorMiddleware::logMessage()` for logging errors and debugging.
- Check logs in the `logs/` directory (if configured).

### Testing
- No explicit test framework is included. Use manual testing for now.
- Verify database operations by inspecting the MariaDB instance.

## Conventions
- **CSRF Protection**:
  - All forms include a hidden CSRF token.
  - Validate tokens in controllers before processing requests.
- **Input Validation**:
  - Use regex patterns for validating usernames and passwords (e.g., in `UsersController`).
- **Session Management**:
  - Sessions are started in `config.php`.
  - Use `session_regenerate_id(true)` after login for security.

## Integration Points
- **OpenAI API**:
  - Managed by `ApiHandler.php`.
  - Generates social media posts and images.
- **RSS Feeds**:
  - Generated by `Utility::outputRssFeed()`.
  - Accessible at `/feeds/{user}/{account}` and `/feeds/{user}/all`.

## Key Files
- `root/config.php`: Central configuration file.
- `root/app/Controllers/AuthController.php`: Handles user authentication.
- `root/app/Models/User.php`: Manages user data.
- `root/app/Core/Utility.php`: Contains helper functions for RSS feeds, IP blacklisting, etc.
- `root/public/install.php`: Sets up the database.

## Notes
- Follow the MVC pattern strictly to maintain code organization.
- Use the `Database` class for all database interactions to ensure consistency.
- Avoid hardcoding sensitive data; use environment variables or `config.php`.

Feel free to update this file as the project evolves.
